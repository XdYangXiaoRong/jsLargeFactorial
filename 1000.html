<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>阶乘</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
  <script src="main.js"></script> -->
</head>
<body>
  <script type="text/javascript">
  var number=50;
  function f(n) {
    // a代表结果 [0]是个位依次类推
    var a = [1];
    for (var i = 1; i <= n; i++) {
        // 判断条件可以理解为为 在j大于当前被乘数的位数的时候，存在进位则强制将a扩增一个位数
        for (var j = 0, c = 0; j < a.length || c != 0; j++) {
            // 每次执行这一此循环时
            // 将进位数归0,当前位数归0,然后从当前位数开始与阶乘数i相乘
            // 用m保存相乘的结果（阶乘数*当前位数+上一位的进位数）
            // 把当前位数设置为m对10取模
            // 把c设置为进位数也就是减去当前位数再除10
            var m = (j < a.length) ? (i * a[j] + c) : c;
            a[j] = m % 10;
            c = (m - a[j]) / 10;
            // console.log("a",j,a)090
        }
    }
    return a.reverse().join("");
  }
  // var a=f(1000)
  // console.log(1111,a)
    /*大数阶乘*/
    function test333(n){
      if(n<=0){
        return
      }
      var count=1;
      for(var i=1;i<n;i++){
        count=count*n;
      }
      return count
    }
    // var result=test333(50);//超出范围了
    // console.log(23333,result)
    
  //  var result=f(number);
  //  console.log(2222,result)
  function chen(count,n){
      if(count===0 || n===0){
        return 0;
      }
      // console.log(count,n)
      var lastArray=[];//二位数组，用来存放count与个位、十位、百位的乘积
      var returnArray=[];//最终结果的数组
      var nArray=n.toString().split('').reverse();//反转数组，从左到右依次是个位、十位、百位……
      var nLength=n.toString().length;
      var countArray=count.toString().split('');
      var maxLength=count.toString().length+nLength-1;
      // console.log("nArray",nArray)
      // console.log("nLength",nLength)
      // console.log("countArray",countArray)
      // console.log("maxLength",maxLength)
        for(var j=0;j<nArray.length;j++){//计算count与每一位的乘积兵保存在数组lastArray中
          // lastArray[j]=
          var newCountArray=[],before=0;//保存上一位的进位信息
          for(var k=countArray.length-1;k>=0;k--){//将count也放在一个数组中
            newCountArray[k]=(nArray[j]*countArray[k]+before)%10;//当前位取余+前一位的进位
            before=Math.floor((nArray[j]*countArray[k]+before)/10);//当前位的进位
            if(k<=0&&before>0){
              newCountArray.unshift(before);
              //最高位进位了，结果最大值加1
            }
          }
          // console.log('newCountArray',newCountArray)
          for(var o=0;o<j;o++){//数组末尾的补0,个位乘n补0个（j=0），十位补一个(j=1)，百位(j=2)补两个……
              newCountArray.push(0);
          }
          // for(var beforeO=newCountArray.length;beforeO<maxLength;beforeO++){
          //   newCountArray.unshift(0);//前面补0
          // }
          lastArray[j]=newCountArray;
          // console.log("J:"+j,lastArray[j])
        }
        // console.log('lastArray',lastArray)
        for(var i=0;i<lastArray.length;i++){//找到某一位最长的结果值
          if(lastArray[i].length>maxLength){
            maxLength=lastArray[i].length;
          }
        }
      
        // console.log('maxLength',maxLength)
        // debugger
        for(var l=0;l<lastArray.length;l++){
          if(lastArray[l].length<maxLength){
            for(var n=lastArray[l].length;n<maxLength;n++){
              lastArray[l].unshift(0);//前面位补0
            }
          }
        }
        // console.log("lastArray2",lastArray)
        //将得到的个位相乘数组，10位相乘数组，百位相乘数组依次相加；
        

        returnArray=new Array(maxLength);
        for(var len=0;len<returnArray.length;len++){
          returnArray[len]=0
        }
        for(var index=lastArray.length-1;index>=0;index--){//从个位依次开始相加
          var lastBefore=0;//像更高位的进位
          for(var i=lastArray[index].length-1;i>=0;i--){
            var temp=returnArray[i]
            returnArray[i]=(temp+lastArray[index][i]+lastBefore)%10;
            lastBefore=Math.floor((temp+lastArray[index][i]+lastBefore)/10);
            // console.log(returnArray[i],lastBefore)
          }
          // console.log(index,returnArray)
          
        }
        return returnArray.join('');

        
  }
  // var result=chen(52345,225);
  // console.log(6666,result)
  function test(n){
    if(n<=0){
      return
    }
    var count=1;
    for(var i=1;i<n;i++){
      count=chen(count,i);
      // console.log(i,before)
    }
    return count
  }
  
  function chen2(count,n){
      if(count===0 || n===0){
        return 0;
      }
      // console.log(count,n)
      var lastArray=[];//二位数组，用来存放count与个位、十位、百位的乘积
      var returnArray=[];//最终结果的数组
      var nArray=n.toString().split('').reverse();//反转数组，从左到右依次是个位、十位、百位……
      var nLength=n.toString().length;
      var countArray=count.toString().split('');
      var maxLength=count.toString().length+nLength-1;
      // console.log("nArray",nArray)
      // console.log("nLength",nLength)
      // console.log("countArray",countArray)
      // console.log("maxLength",maxLength)
        for(var j=0;j<nArray.length;j++){//计算count与每一位的乘积兵保存在数组lastArray中
          // lastArray[j]=
          var newCountArray=[],before=0;//保存上一位的进位信息
          for(var k=countArray.length-1|| before!=0;k>=0;k--){//将count也放在一个数组中
            newCountArray[k]=(nArray[j]*countArray[k]+before)%10;//当前位取余+前一位的进位
            // var temp=before
            // before=Math.floor((nArray[j]*countArray[k]+temp)/10);//当前位的进位
            before=(nArray[j]*countArray[k]+before-newCountArray[k])/10
            if(k<=0&&before!=0){
              newCountArray.unshift(before);
              // 最高位进位了，结果最大值加1
            }
          }
         
          // console.log('newCountArray',newCountArray)
          lastArray[j]=newCountArray.reverse();
        }
        console.log('lastArray',lastArray)//lastArray依次保存着个位数与cout，10位数与count，百位数与count……的乘积的数组
        for(var i=0;i<lastArray.length;i++){
          if(lastArray.length===0){
            returnArray=lastArray[0]
            break;
          }
          for(var j=0;j<i;j++){
            lastArray[i].unshift(0);//不足的自动补零
          }
          var before2=0;
          for(var x=0;x<lastArray[i].length;x++){
            var temp=returnArray[x];
            if(!temp){
              temp=0;
            }
            returnArray[x]=(temp+lastArray[i][x]+before2)%10;
            var temp2=before2;
            // before2=Math.floor((temp+lastArray[i][x]+temp2)/10);
            before2=(temp+lastArray[i][x]+before2-returnArray[x])/10
            console.log(i,returnArray)
          }
          
        }
        //将得到的个位相乘数组，10位相乘数组，百位相乘数组依次相加；
        
        return returnArray.reverse().join('');      
   }
  var result2=chen2(1234567890,1234567890);
  console.log(111,result2)
  // console.log(chen(123,123456))
  function f(n) {
    // a代表结果 [0]是个位依次类推
    var a = [1];
    for (var i = 1; i <= n; i++) {
        // 判断条件可以理解为为 在j大于当前被乘数的位数的时候，存在进位则强制将a扩增一个位数
        for (var j = 0, c = 0; j < a.length || c != 0; j++) {
            // 每次执行这一此循环时
            // 将进位数归0,当前位数归0,然后从当前位数开始与阶乘数i相乘
            // 用m保存相乘的结果（阶乘数*当前位数+上一位的进位数）
            // 把当前位数设置为m对10取模
            // 把c设置为进位数也就是减去当前位数再除10
            var m = (j < a.length) ? (i * a[j] + c) : c;
            a[j] = m % 10;
            c = (m - a[j]) / 10;
            // console.log("a",i,j,a)
        }
    }
    return a.reverse().join("");
  }
  // result=f(1000);
  // console.log(result)
  </script>
</body>
</html>